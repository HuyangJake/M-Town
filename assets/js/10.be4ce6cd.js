(window.webpackJsonp=window.webpackJsonp||[]).push([[10],{368:function(t,a,s){"use strict";s.r(a);var n=s(0),e=Object(n.a)({},(function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h2",{attrs:{id:"注册小程序"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#注册小程序"}},[t._v("#")]),t._v(" 注册小程序")]),t._v(" "),s("p",[s("strong",[t._v("前台、后台定义")]),t._v("： 当用户点击左上角关闭，或者按了设备 Home 键离开微信，小程序并没有直接销毁，而是进入了后台；当再次进入微信或再次打开小程序，又会从后台进入前台。需要注意的是：只有当小程序进入后台一定时间，或者系统资源占用过高，才会被真正的销毁。")]),t._v(" "),s("p",[s("strong",[t._v("关闭小程序")]),t._v("(公共库版本1.1.0开始支持)： 当用户从扫一扫、转发等入口(场景值为1007, 1008, 1011, 1025)进入小程序，且没有置顶小程序的情况下退出，小程序会被销毁。")]),t._v(" "),s("p",[t._v("在"),s("code",[t._v("onLaunch")]),t._v("和"),s("code",[t._v("onShow")]),t._v("方法中可以获得的参数：")]),t._v(" "),s("p",[s("img",{attrs:{src:"http://qiniu.huyangjie.cn/onLaunch%E5%8F%82%E6%95%B0",alt:""}})]),t._v(" "),s("p",[t._v("注意：")]),t._v(" "),s("ul",[s("li",[s("p",[t._v("App() 必须在 app.js 中注册，且不能注册多个。")])]),t._v(" "),s("li",[s("p",[t._v("不要在定义于 App() 内的函数中调用 getApp() ，使用 this 就可以拿到 app 实例。")])]),t._v(" "),s("li",[s("p",[t._v("不要在 onLaunch 的时候调用 getCurrentPages()，此时 page 还没有生成。")])]),t._v(" "),s("li",[s("p",[t._v("通过 getApp() 获取实例之后，不要私自调用生命周期函数。")])])]),t._v(" "),s("h2",{attrs:{id:"注册页面"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#注册页面"}},[t._v("#")]),t._v(" 注册页面")]),t._v(" "),s("h3",{attrs:{id:"生命周期函数"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#生命周期函数"}},[t._v("#")]),t._v(" 生命周期函数")]),t._v(" "),s("ul",[s("li",[t._v("onLoad: 页面加载\n"),s("ul",[s("li",[t._v("一个页面只会调用一次，可以在 onLoad 中获取打开当前页面所调用的 query 参数。")])])]),t._v(" "),s("li",[t._v("onShow: 页面显示\n"),s("ul",[s("li",[t._v("每次打开页面都会调用一次。")])])]),t._v(" "),s("li",[t._v("onReady: 页面初次渲染完成\n"),s("ul",[s("li",[t._v("一个页面只会调用一次，代表页面已经准备妥当，可以和视图层进行交互。")]),t._v(" "),s("li",[t._v("对界面的设置如wx.setNavigationBarTitle请在onReady之后设置。详见生命周期")])])]),t._v(" "),s("li",[t._v("onHide: 页面隐藏\n"),s("ul",[s("li",[t._v("当navigateTo或底部tab切换时调用。")])])]),t._v(" "),s("li",[t._v("onUnload: 页面卸载\n"),s("ul",[s("li",[t._v("当redirectTo或navigateBack的时候调用。")])])])]),t._v(" "),s("h4",{attrs:{id:"onshareappmessage"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#onshareappmessage"}},[t._v("#")]),t._v(" onShareAppMessage")]),t._v(" "),s("p",[t._v("转发小程序时需要添加的自定义转字段：")]),t._v(" "),s("div",{staticClass:"language-Javascript line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[t._v("Page")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("onShareAppMessage")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      title"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'自定义转发标题'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      path"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/page/user?id=123'")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br"),s("span",{staticClass:"line-number"},[t._v("8")]),s("br")])]),s("h3",{attrs:{id:"事件处理函数"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#事件处理函数"}},[t._v("#")]),t._v(" 事件处理函数")]),t._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v('\x3c!--index.wxml--\x3e\n<view>{{text}}</view>\n<button bindtap="changeText"> Change normal data </button>\n')])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br")])]),s("div",{staticClass:"language-javascript line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[t._v("Page")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  data"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    text"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'init data'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("changeText")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// this.data.text = 'changed data'  // bad, it can not work")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("setData")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      text"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'changed data'")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br"),s("span",{staticClass:"line-number"},[t._v("8")]),s("br"),s("span",{staticClass:"line-number"},[t._v("9")]),s("br"),s("span",{staticClass:"line-number"},[t._v("10")]),s("br")])]),s("p",[t._v("Tips")]),t._v(" "),s("ul",[s("li",[t._v("直接修改 this.data 而不调用 this.setData 是无法改变页面的状态的，还会造成数据不一致")]),t._v(" "),s("li",[t._v("单次设置的数据不能超过1024kB，请尽量避免一次设置过多的数据。")])]),t._v(" "),s("p",[t._v("下图为page实例的生命周期：\n"),s("img",{attrs:{src:"https://mp.weixin.qq.com/debug/wxadoc/dev/image/mina-lifecycle.png?t=2017527",alt:""}})]),t._v(" "),s("h2",{attrs:{id:"路由"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#路由"}},[t._v("#")]),t._v(" 路由")]),t._v(" "),s("p",[t._v("小程序的页面用栈的形式进行维护管理，大致与iOS相似。")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",{staticStyle:{"text-align":"center"}},[t._v("路由方式")]),t._v(" "),s("th",{staticStyle:{"text-align":"center"}},[t._v("API")]),t._v(" "),s("th",{staticStyle:{"text-align":"center"}},[t._v("页面栈表现")])])]),t._v(" "),s("tbody",[s("tr",[s("td",{staticStyle:{"text-align":"center"}},[t._v("初始化")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}}),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("新页面入栈")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"center"}},[t._v("打开新页面")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("wx.navigateTo")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("新页面入栈")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"center"}},[t._v("页面重定向")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("wx.redirectTo")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("当前页面出栈，新页面入栈")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"center"}},[t._v("页面返回")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("wx.navigateBack")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("页面不断出栈，直到目标返回页，新页面入栈")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"center"}},[t._v("Tab 切换")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("wx.switchTab")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("页面全部出栈，只留下新的 Tab 页面")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"center"}},[t._v("重加载")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("wx.reLaunch")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("页面全部出栈，只留下新的页面")])])])]),t._v(" "),s("p",[t._v("页面重定向在iOS的UINavigation中没有对应。")]),t._v(" "),s("p",[t._v("tab切换在小程序里竟然是页面全部出栈，留下最新的tab页。我在iOS中的处理一般是，每个tab页拥有自己的Navigation，切换tab就切换当先使用的Navigation。"),s("em",[t._v("系统底层的实现应该也是不是小程序这样，等待去研究下回来跟新这里吧")])]),t._v(" "),s("p",[t._v("重加载，这一项有点疑惑。当我在比较深层的页面刷新重加载一下，整个栈里就只剩下当前页面了？！那程序的层次结构怎么办，还是说回到了首页，这体验很糟糕啊。")]),t._v(" "),s("p",[t._v("Tips:")]),t._v(" "),s("ul",[s("li",[t._v("navigateTo, redirectTo 只能打开非 tabBar 页面。")]),t._v(" "),s("li",[t._v("switchTab 只能打开 tabBar 页面。")]),t._v(" "),s("li",[t._v("reLaunch 可以打开任意页面。")]),t._v(" "),s("li",[t._v("页面底部的 tabBar 由页面决定，即只要是定义为 tabBar 的页面，底部都有 tabBar。")]),t._v(" "),s("li",[t._v("调用页面路由带的参数可以在目标页面的onLoad中获取。")])]),t._v(" "),s("h2",{attrs:{id:"模块化"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#模块化"}},[t._v("#")]),t._v(" 模块化")]),t._v(" "),s("p",[t._v("将公共的代码抽离出来，放到一个单独的js文件中作为一个模块。模块只有通过 module.exports 或者 exports 才能对外暴露接口。")]),t._v(" "),s("div",{staticClass:"language-javascript line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// common.js")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("sayHello")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  console"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token template-string"}},[s("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("Hello ")]),s("span",{pre:!0,attrs:{class:"token interpolation"}},[s("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("${")]),t._v("name"),s("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("}")])]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v(" !")]),s("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\nmodule"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("exports"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("sayHello "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" sayHello\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br")])]),s("p",[t._v("在调用的时候使用"),s("code",[t._v("require(path)")]),t._v("把需要的代码引入")]),t._v(" "),s("div",{staticClass:"language-javascript line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" common "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'common.js'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("Page")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("helloMINA")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    common"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("sayHello")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'MINA'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br")])]),s("h2",{attrs:{id:"参考微信小程序文档"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#参考微信小程序文档"}},[t._v("#")]),t._v(" "),s("a",{attrs:{href:"https://mp.weixin.qq.com/debug/wxadoc/dev/framework/app-service/app.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("参考微信小程序文档"),s("OutboundLink")],1)])])}),[],!1,null,null,null);a.default=e.exports}}]);