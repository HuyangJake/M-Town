(window.webpackJsonp=window.webpackJsonp||[]).push([[29],{344:function(s,e,t){"use strict";t.r(e);var a=t(0),n=Object(a.a)({},function(){var s=this,e=s.$createElement,t=s._self._c||e;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h2",{attrs:{id:"getting-around-rootless"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#getting-around-rootless","aria-hidden":"true"}},[s._v("#")]),s._v(" Getting around Rootless")]),s._v(" "),t("p",[s._v("OS X 10.11 中引入的 Rootless，即使是root用户，也无法对以下路径有写和执行的权限：")]),s._v(" "),t("pre",[t("code",[s._v("/System\n/bin\n/sbin\n/usr (except /usr/local)\n只有Apple自身签名的软件（含命令行工具）可以。\n")])]),s._v(" "),t("p",[s._v("Apple的Rootless机制虽然保护了系统的安全，防止了大部分恶意软件想通过单纯的引导用户，输入自己的密码点击确定来直接切换到root做一些违法的事情。也可以防止黑客黑了一个用户然后就有root权限可以肆意妄为的情况，不过对于真正的黑客来说")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://pic2.zhimg.com/e3a51869c1a65e3cb56378470b5af695_b.jpg",alt:""}})]),s._v(" "),t("h2",{attrs:{id:"disabling-rootless"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#disabling-rootless","aria-hidden":"true"}},[s._v("#")]),s._v(" Disabling Rootless")]),s._v(" "),t("p",[s._v("在电脑的Recovery Mode，打开终端输入")]),s._v(" "),t("pre",[t("code",[s._v("csrutil disable; reboot\n")])]),s._v(" "),t("p",[s._v("电脑会重启，此时电脑就禁用了Rootless，可以调试系统级别的应用。")]),s._v(" "),t("p",[s._v("可以使用命令：")]),s._v(" "),t("pre",[t("code",[s._v("lldb -n Finder\n")])]),s._v(" "),t("p",[s._v("看到类似以下信息就表示成功")]),s._v(" "),t("pre",[t("code",[s._v("Process XXX stoped\n.\n.\n.\n")])]),s._v(" "),t("h2",{attrs:{id:"attaching-lldb-to-xcode"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#attaching-lldb-to-xcode","aria-hidden":"true"}},[s._v("#")]),s._v(" Attaching LLDB to Xcode")]),s._v(" "),t("p",[s._v("使用"),t("code",[s._v("lldb")]),s._v(" attach 到最常用的工具Xcode！")]),s._v(" "),t("p",[s._v("方式一：")]),s._v(" "),t("pre",[t("code",[s._v("lldb file /Applications/Xcode.app/Contents/MacOS/Xcode\n")])]),s._v(" "),t("p",[s._v("方式二：")]),s._v(" "),t("pre",[t("code",[s._v("lldb -n Xcode  //需要Xcode在运行状态\n")])]),s._v(" "),t("p",[s._v("方式三：")]),s._v(" "),t("pre",[t("code",[s._v("pgrep -x Xcode  //需要Xcode在运行状态\nlldb -p 89921 //89921为Xcode的PID\n")])]),s._v(" "),t("p",[s._v("方式四：(attaching 一个将会运行的程序)")]),s._v(" "),t("pre",[t("code",[s._v("lldb -n Finder -w\n\npkill Finder\n")])]),s._v(" "),t("p",[s._v("运行程序：")]),s._v(" "),t("pre",[t("code",[s._v("process lanuch -e /dev/ttys004 --\n")])]),s._v(" "),t("p",[s._v("这里的"),t("code",[s._v("ttys004")]),s._v("是shell中的某个tab的唯一id")]),s._v(" "),t("hr"),s._v(" "),t("h3",{attrs:{id:"运行程序时可以携带的参数："}},[t("a",{staticClass:"header-anchor",attrs:{href:"#运行程序时可以携带的参数：","aria-hidden":"true"}},[s._v("#")]),s._v(" 运行程序时可以携带的参数：")]),s._v(" "),t("ul",[t("li",[s._v("通过"),t("code",[s._v("-w")]),s._v("参数改变运行程序的目录：")])]),s._v(" "),t("div",{staticClass:"language-lldb line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("(lldb) process launch -w /Applications\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("ul",[t("li",[s._v("也可以直接将参数加到程序后面：")])]),s._v(" "),t("div",{staticClass:"language-lldb line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("(lldb) process launch -- /Applications\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("ul",[t("li",[t("code",[s._v("-X")]),s._v("参数让 "),t("code",[s._v("shell")]),s._v(" 接受任何格式参数，比如下面这种 "),t("code",[s._v("~")]),s._v(" 字符")])]),s._v(" "),t("div",{staticClass:"language-lldb line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("(lldb) process launch -X true -- ~/Desktop\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("ps： "),t("code",[s._v("run")]),s._v(" 命令是上面 "),t("code",[s._v("process launch -X true --")]),s._v(" 的简写")]),s._v(" "),t("p",[s._v("可以直接  "),t("code",[s._v("run ~/Desktop")])]),s._v(" "),t("ul",[t("li",[t("code",[s._v("-o")]),s._v(" 命令让LLDB输出到指定的文件")])]),s._v(" "),t("div",{staticClass:"language-lldb line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("(lldb) process launch -o /tmp/ls_output.txt -- /Applications\n\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("ul",[t("li",[t("code",[s._v("-i")]),s._v(" 命令可以从外部文件读取数据，这在不想stdin的状况下很有用（还没有体会到😌 ）")])]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("lldb"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" process launch -i /tmp/wc_input.txt\n\n等同于\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("wc")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v(" /tmp/wc_input.txt  //wc为当前lldb的target\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br")])]),t("ul",[t("li",[t("code",[s._v("-n")]),s._v(" 命令告诉LLDB不要创建stdin")])]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("(lldb) process launch -n\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("hr"),s._v(" "),t("p",[s._v("按"),t("code",[s._v("Ctrl + C")]),s._v("可以暂停debugger， 添加一个断点：")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[s._v("breakpoint "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("set")]),s._v(" -n "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"-[NSView hitTest:]"')]),s._v("\t\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("continue")]),s._v(" //断点后继续执行\npo "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$rdi")]),s._v(" // 查看RDI CPU register\t\n//修改一个断点，添加一个触发条件\nbreakpoint modify 1 -c "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"(BOOL)['),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$rdi")]),s._v(' isKindOfClass:[NSTextView class]]"')]),s._v(" \n\t\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br")])]),t("p",[s._v("内容出处：\n"),t("strong",[s._v("《Advanced Apple Debugging & Reverse Engineering》")])])])},[],!1,null,null,null);e.default=n.exports}}]);